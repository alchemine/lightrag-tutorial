LightRAG는 그래프 데이터베이스와 벡터 스토리지를 기반으로 다양한 노드와 엣지를 통해 정보를 저장하고 검색하는 시스템입니다. 이 시스템의 주요 작동 방식은 다음과 같습니다:

### 1. 데이터 저장 및 관리
LightRAG에서는 정보를 **노드(node)**와 **엣지(edge)**로 구조화하여 저장합니다. 노드는 특정 엔티티를 나타내고, 엣지는 그들 간의 관계를 나타냅니다. 데이터는 특정 **워크스페이스**에 속하며, 각 노드와 엣지는 그에 대한 메타데이터(예: 설명, 키워드)를 포함할 수 있습니다. 

- **Merge Operations**: 노드나 엣지를 추가할 때, 이미 존재하는지를 확인한 후, 존재하지 않는 경우에만 삽입하는 방식으로 데이터의 중복을 방지합니다. 이를 통해 데이터의 일관성을 유지할 수 있습니다.

### 2. 벡터 검색
LightRAG는 벡터 검색 기능을 통해 각 노드와 엣지의 **content_vector**를 이용하여 유사한 항목을 찾습니다. 주어진 임베딩(embedding)을 기반으로 유사도를 계산하는 **COSINE** 거리를 사용합니다. 

- **Entities and Relationships Retrieval**: 특정 임베딩과 유사한 노드를 검색하기 위해 벡터 거리를 계산하고, 정의된 임계값보다 가까운 노드와 관계를 요청하여 관련되는 정보를 효과적으로 찾습니다.

### 3. 데이터 쿼리
LightRAG에서는 각종 SQL-like 쿼리를 통해 노드를 검색하거나 관련된 엣지를 조회할 수 있습니다. 예를 들어, 특정 노드가 가진 엣지나 해당 노드의 세부 정보를 쉽게 조회할 수 있습니다. 

- **Statistics**: 데이터베이스의 통계를 조회하여 노드와 엣지의 수를 파악할 수 있는 쿼리도 지원하여, 시스템의 상태를 점검하는 데 유용합니다.

### 4. 그래프 기반 탐색
LightRAG에서는 그래프를 탐색하여 노드 간의 관계를 시각화하고, 관계 맵을 통해 정보 간의 연결을 이해하기 쉽게 나타냅니다. 이를 통해 복잡한 데이터 구조와 관계를 명확히 할 수 있습니다.

결과적으로, LightRAG는 벡터 기반 검색 기능과 그래프 데이터 구조를 활용하여 정보를 효율적으로 저장하고 검색하는 강력한 도구로, 다양한 분야에서 데이터 관리 및 분석에 활용될 수 있습니다.